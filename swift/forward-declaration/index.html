<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="og:site_name" content="YoSwift!"/><link rel="canonical" href="https://yoswift.dev/swift/forward-declaration"/><meta name="twitter:url" content="https://yoswift.dev/swift/forward-declaration"/><meta name="og:url" content="https://yoswift.dev/swift/forward-declaration"/><title>Forward declaring protocols | YoSwift!</title><meta name="twitter:title" content="Forward declaring protocols | YoSwift!"/><meta name="og:title" content="Forward declaring protocols | YoSwift!"/><meta name="description" content="forward declaration, build time, mixed code"/><meta name="twitter:description" content="forward declaration, build time, mixed code"/><meta name="og:description" content="forward declaration, build time, mixed code"/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="/styles.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to YoSwift!"/><meta name="twitter:image" content="https://yoswift.dev/images/logo.png"/><meta name="og:image" content="https://yoswift.dev/images/logo.png"/></head><body class="item-page"><header><a id="logo" href="/"><img src="/images/logo.png" alt="Yo! Swift"/></a><nav id="main-navigation"><ul><li><a href="/swiftui">SwiftUI</a></li><li><a class="selected" href="/swift">Swift</a></li><li><a href="/combine">Combine</a></li><li><a href="/about">About</a></li><li><a href="/apps">Apps</a></li></ul></nav></header><div class="wrapper"><span>May 5, 2021</span><article><div class="content"><h1>Forward declaring protocols</h1><p>Let's talk about header files today in Objc. It is wise to always prefer forward declaring your types in .h file</p><ol><li>Sometime to avoid circular dependencies</li><li>It is always better for incremental build</li></ol><p>The related <a href="https://en.wikipedia.org/wiki/Forward_declaration#:~:text=Classes,-In%20some%20object&text=In%20C%2B%2B%2C%20classes%20and,what%20the%20compiler%20cares%20about">wiki page</a> list benefits clearly</p><ul><li>reduce the number of files opened by #include (hence the number of operating system calls)</li><li>reducing the volume of the pre-processed files (as the header is not included)</li><li>reducing recompilation impact when the forward declared class is modified.</li></ul><p>Forward declaration is possible when compiler don't need to know the structure (properties inside) but only name e.g. types used in a method signature.</p><p>Let's see this code.</p><pre><code>#import <span class="string">"SomeProtocol.h"</span> <span class="comment">// Forward declration will produce compliation error</span>

<span class="keyword">@interface</span> <span class="type">SomeObject</span>: <span class="type">NSObject</span>&lt;<span class="type">SomeProtocol</span>&gt;
<span class="keyword">@end</span>
</code></pre><p>Here as <code>SomeObject</code> is conforming to <code>SomeProtocol</code> It is not possible to forward declare the protocol as it became "part" of <code>SomeObject</code> and compiler need to see the SomeProtocol definition when compiling any file that includes <code>SomeObject.h</code> to</p><p>Now the purpose of conforming SomeObject to SomeProtocol most likely will be that some part of the code is passing an instance of SomeObject to somewhere as SomeProtocol type.</p><p>If it is the case and you want to still forward declare your protocol (it is better, we know), you can use this nice tip.</p><pre><code><span class="keyword">@protocol</span> <span class="string">"SomeProtocol.h"</span> <span class="comment">// Forward declration will work now</span>

<span class="keyword">@interface</span> <span class="type">SomeObject</span>: <span class="type">NSObject</span>
- (id&lt;<span class="type">SomeProtocol</span>&gt;) asSomeProtocol <span class="comment">// This make possible to use instance of SomeObject as SomeProtocol</span>
<span class="keyword">@end</span>
</code></pre><p>So still we were able to forward declare the protocol and also can call asSomeProtocol on instance of SomeObject to pass it as type SomeProtocol.</p><a href="https://twitter.com/intent/tweet?via=mskarki&amp;text=Forward declare a protocol&amp;url=https%3A//yoswift.dev/swift/forward-declaration" rel="nofollow">Share this article</a></div><span>Tagged with: </span><br/><ul class="tag-list-swift"><li><a href="/tags/swift">swift</a></li><li><a href="/tags/objc">Objc</a></li></ul></article></div><footer><p>Coded in Swift, generated using <a href="https://github.com/johnsundell/publish">Publish</a></p><p><a href="/feed.rss">RSS feed</a></p></footer></body></html>